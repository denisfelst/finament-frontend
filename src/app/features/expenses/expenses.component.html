<h2>Expenses</h2>

@if (loading()) {
<app-loading></app-loading>
} @if (error()) {
<app-error [error]="error()"></app-error>
}

<!-- content  -->
@if (!loading() && !error()) { @if(message()){
<div class="bg-green-400">
  {{ message() }}
</div>
} @if(error()){
<app-error [error]="error()"></app-error>
} @if (loading()) {
<app-loading></app-loading>
}

<ul>
  @for (exp of orderedExpenses(); let i = $index; track exp.id) {
  <li>
    <span>
      #{{ orderedExpenses().length - i }} - {{ exp.amount }} —
      {{ exp.categoryId }} — {{ exp.tag }}
      <!-- {{ exp.date }} -->
      -
    </span>
    <!-- TODO: integrate in whole div -->
    <button (click)="setModal(exp.id)" popovertarget="modal">Edit</button>
  </li>
  }
</ul>

<app-full-modal
  [name]="currentModal() ?? ''"
  [open]="currentModal() !== null"
  (close)="setModal(null)"
>
  <app-expense-form
    [categories]="categories()"
    [expense]="currentExpense()"
    (submission)="onSubmit($event)"
    (delete)="handleDeletePress()"
  ></app-expense-form>
</app-full-modal>

<app-confirmation-modal
  [open]="confirmation()"
  (submission)="onDelete($event)"
></app-confirmation-modal>
}
